<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Endurance Fuel Planner</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f9fafb; }
        .container { max-width: 1200px; margin: 0 auto; padding: 1.5rem; }
        .header { background: linear-gradient(to right, #2563eb, #9333ea); color: white; padding: 2rem; border-radius: 0.5rem; margin-bottom: 1.5rem; }
        .header h1 { font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem; }
        .tabs { background: white; border-radius: 0.5rem; padding: 0.25rem; display: flex; gap: 1rem; margin-bottom: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .tab { flex: 1; padding: 0.75rem 1rem; border: none; background: none; border-radius: 0.375rem; cursor: pointer; font-size: 1rem; color: #6b7280; }
        .tab:hover { background: #f3f4f6; }
        .tab.active { background: #dbeafe; color: #1d4ed8; font-weight: 500; }
        .tab:disabled { opacity: 0.5; cursor: not-allowed; }
        .card { background: white; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 1.5rem; }
        .card h2 { font-size: 1.5rem; font-weight: bold; margin-bottom: 1.5rem; }
        .card h3 { font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.5rem; }
        .form-group input, .form-group select { padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 1rem; width: 100%; }
        .btn { padding: 0.75rem 2rem; border: none; border-radius: 0.5rem; font-size: 1rem; font-weight: 500; cursor: pointer; margin-top: 2rem; }
        .btn-primary { background: linear-gradient(to right, #2563eb, #9333ea); color: white; }
        .btn-primary:hover { transform: scale(1.02); }
        .btn-small { padding: 0.5rem 1rem; font-size: 0.875rem; margin-top: 0.5rem; width: 100%; }
        .btn-add { background: #2563eb; color: white; }
        .btn-remove { background: #dc2626; color: white; padding: 0.5rem 1rem; font-size: 0.875rem; }
        .results-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 2rem; background: linear-gradient(to right, #f0fdf4, #dbeafe); padding: 1.5rem; border-radius: 0.5rem; }
        .result-box { background: white; padding: 1rem; border-radius: 0.5rem; text-align: center; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .result-value { font-size: 1.5rem; font-weight: bold; margin-bottom: 0.25rem; }
        .result-value.green { color: #16a34a; }
        .result-value.orange { color: #ea580c; }
        .result-value.blue { color: #2563eb; }
        .result-value.purple { color: #9333ea; }
        .result-label { font-size: 0.875rem; color: #6b7280; }
        .result-sublabel { font-size: 0.75rem; color: #9ca3af; }
        .product-item { background: #f9fafb; padding: 1rem; border-radius: 0.5rem; margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
        .product-info { flex: 1; min-width: 200px; }
        .product-name { font-weight: 500; }
        .product-category { color: #6b7280; font-size: 0.875rem; }
        .product-details { color: #6b7280; font-size: 0.875rem; margin-top: 0.25rem; }
        .product-controls { display: flex; align-items: center; gap: 0.5rem; }
        .qty-input { width: 60px; padding: 0.5rem; text-align: center; border: 1px solid #d1d5db; border-radius: 0.25rem; }
        .dropdown-section select { width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; margin-bottom: 0.75rem; font-size: 1rem; }
        .quantity-section { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem; }
        .quantity-section label { font-size: 0.875rem; color: #6b7280; font-weight: 500; }
        .quantity-section input { width: 80px; padding: 0.5rem; text-align: center; border: 1px solid #d1d5db; border-radius: 0.375rem; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Endurance Fuel Planner</h1>
            <p>Science-based nutrition planning for runners, cyclists & triathletes</p>
        </div>

        <div class="tabs">
            <button class="tab active" id="calcTab" onclick="showTab('calc')">Calculate Needs</button>
            <button class="tab" id="prodTab" onclick="showTab('prod')" disabled>Select Products</button>
        </div>

        <div id="calcView">
            <div class="card">
                <h2>Activity Details</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Activity Type</label>
                        <select id="activity">
                            <option value="running">Running</option>
                            <option value="cycling">Cycling</option>
                            <option value="triathlon">Triathlon</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Duration (minutes)</label>
                        <input type="number" id="duration" value="120" min="30" max="720">
                    </div>
                    <div class="form-group">
                        <label>Training Zone</label>
                        <select id="intensity">
                            <option value="zone1">Zone 1 (Recovery)</option>
                            <option value="zone2" selected>Zone 2 (Aerobic Base)</option>
                            <option value="zone3">Zone 3 (Tempo)</option>
                            <option value="zone4">Zone 4 (Threshold)</option>
                            <option value="zone5">Zone 5 (VO2 Max)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Temperature (°F)</label>
                        <input type="number" id="temperature" value="68" min="0" max="120">
                    </div>
                    <div class="form-group">
                        <label>Humidity (%)</label>
                        <input type="number" id="humidity" value="50" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label>Body Weight (lbs)</label>
                        <input type="number" id="bodyWeight" value="154" min="90" max="350">
                    </div>
                    <div class="form-group">
                        <label>Sweat Rate</label>
                        <select id="sweatRate">
                            <option value="low">Low Sweater</option>
                            <option value="medium" selected>Average Sweater</option>
                            <option value="high">Heavy Sweater</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="calc()">Calculate Nutrition Requirements</button>
                <div id="results" class="hidden">
                    <div class="results-grid">
                        <div class="result-box">
                            <div class="result-value green" id="totalCarbs">0g</div>
                            <div class="result-label">Total Carbohydrates</div>
                            <div class="result-sublabel" id="carbsPerHour">0g/hour</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value blue" id="totalFluid">0ml</div>
                            <div class="result-label">Total Fluid</div>
                            <div class="result-sublabel" id="fluidPerHour">0ml/hour</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value orange" id="totalSodium">0mg</div>
                            <div class="result-label">Total Sodium</div>
                            <div class="result-sublabel" id="sodiumPerHour">0mg/hour</div>
                        </div>
                        <div class="result-box">
                            <div class="result-value purple" id="totalCaffeine">0mg</div>
                            <div class="result-label">Recommended Caffeine</div>
                            <div class="result-sublabel">Optional</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="prodView" class="hidden">
            <div id="selectedBox" class="card hidden">
                <h3>Your Selected Products</h3>
                <div id="prodList"></div>
                <div class="results-grid">
                    <div class="result-box">
                        <div class="result-value orange" id="remCarbs">0g</div>
                        <div class="result-label">Carbs Remaining</div>
                        <div class="result-sublabel" id="carbsProg">0g of 0g</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value orange" id="remSodium">0mg</div>
                        <div class="result-label">Sodium Remaining</div>
                        <div class="result-sublabel" id="sodiumProg">0mg of 0mg</div>
                    </div>
                    <div class="result-box">
                        <div class="result-value purple" id="totalCal">0</div>
                        <div class="result-label">Total Calories</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Liquids</h3>
                <div class="dropdown-section">
                    <select id="sel1"></select>
                    <div class="quantity-section">
                        <label>Quantity:</label>
                        <input type="number" id="qty1" value="1" min="1" max="20">
                        <button class="btn btn-small btn-add" onclick="add(1)">Add to Plan</button>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Gels & Solid Foods</h3>
                <div class="dropdown-section">
                    <select id="sel2"></select>
                    <div class="quantity-section">
                        <label>Quantity:</label>
                        <input type="number" id="qty2" value="1" min="1" max="20">
                        <button class="btn btn-small btn-add" onclick="add(2)">Add to Plan</button>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Electrolyte Supplements</h3>
                <div class="dropdown-section">
                    <select id="sel3"></select>
                    <div class="quantity-section">
                        <label>Quantity:</label>
                        <input type="number" id="qty3" value="1" min="1" max="20">
                        <button class="btn btn-small btn-add" onclick="add(3)">Add to Plan</button>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Whole Foods</h3>
                <div class="dropdown-section">
                    <select id="sel4"></select>
                    <div class="quantity-section">
                        <label>Quantity:</label>
                        <input type="number" id="qty4" value="1" min="1" max="20">
                        <button class="btn btn-small btn-add" onclick="add(4)">Add to Plan</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        var db = [
            [{n:'Maurten Drink Mix 160',c:40,s:200,cal:160},{n:'SIS Go Energy + Electrolyte',c:36,s:200,cal:142},{n:'Skratch Labs Sport Drink',c:20,s:380,cal:80},{n:'Precision Hydration PH 1000',c:30,s:1000,cal:120},{n:'Tailwind Endurance Fuel',c:25,s:303,cal:100},{n:'Tailwind Recovery Mix',c:32,s:280,cal:200},{n:'Tailwind Rebuild Recovery',c:11,s:610,cal:100},{n:'Untapped Maple Sports Drink',c:24,s:250,cal:100},{n:'Infinit Custom Mix',c:35,s:400,cal:140},{n:'Gatorade Endurance',c:21,s:300,cal:80},{n:'UCAN Edge',c:15,s:250,cal:90},{n:'First Endurance EFS',c:30,s:275,cal:120},{n:'Nuun Sport + Caffeine',c:1,s:300,cal:10}],
            [{n:'Maurten Gel 100',c:25,s:50,cal:100},{n:'SIS Go Gel',c:22,s:50,cal:87},{n:'GU Energy Gel',c:23,s:50,cal:100},{n:'Clif Shot Gel',c:24,s:85,cal:100},{n:'Hammer Gel',c:23,s:20,cal:90},{n:'PowerBar Gel',c:28,s:200,cal:110},{n:'Honey Stinger Gel',c:24,s:50,cal:100},{n:'Spring Energy Gel',c:22,s:80,cal:96},{n:'UCAN Edge Gel',c:20,s:55,cal:80},{n:'Torq Gel',c:30,s:40,cal:117},{n:'Untapped Maple Packet',c:14,s:2,cal:56},{n:'Clif Bar',c:44,s:250,cal:250},{n:'PowerBar Energize',c:45,s:190,cal:230},{n:'Bonk Breaker Bar',c:20,s:125,cal:130},{n:'Skratch Labs Bar',c:20,s:140,cal:130},{n:'Honey Stinger Waffle',c:21,s:60,cal:140},{n:'Maurten Solid 160',c:40,s:50,cal:160},{n:'Feed Zone Rice Cake',c:30,s:200,cal:130},{n:'Näak Ultra Bar',c:35,s:320,cal:190},{n:'Torq Bar',c:30,s:100,cal:140},{n:'First Endurance Bar',c:26,s:180,cal:140},{n:'Untapped Waffle',c:22,s:150,cal:130}],
            [{n:'SaltStick Caps',c:0,s:215,cal:0},{n:'SaltStick FastChews',c:2,s:50,cal:10},{n:'LMNT Mix',c:0,s:1000,cal:0},{n:'Nuun Electrolytes',c:1,s:300,cal:10},{n:'Liquid IV',c:11,s:500,cal:45},{n:'Precision PH 1500',c:0,s:1500,cal:0},{n:'Base Electrolyte',c:0,s:320,cal:0},{n:'Skratch Hydration',c:0,s:380,cal:0}],
            [{n:'Banana',c:27,s:1,cal:105},{n:'Dates (3)',c:20,s:1,cal:80},{n:'Fig Bars (2)',c:22,s:100,cal:110},{n:'Rice with Salt',c:30,s:300,cal:130},{n:'Sweet Potato',c:20,s:7,cal:90},{n:'Oatmeal with Salt',c:25,s:200,cal:140},{n:'Bread + Jam',c:30,s:150,cal:140},{n:'Pretzels',c:22,s:486,cal:108},{n:'Homemade Drink',c:15,s:250,cal:60},{n:'Maple Syrup',c:13,s:2,cal:52}]
        ];
        var reqs = null;
        var picks = [];

        window.onload = function() {
            for(var i=0; i<4; i++) {
                var sel = document.getElementById('sel'+(i+1));
                var opt = document.createElement('option');
                opt.value = '';
                opt.textContent = 'Select a product...';
                sel.appendChild(opt);
                db[i].forEach(function(p) {
                    var opt = document.createElement('option');
                    opt.value = p.n;
                    opt.textContent = p.n + ' - ' + p.c + 'g carbs, ' + p.s + 'mg sodium';
                    sel.appendChild(opt);
                });
            }
        };

        function showTab(t) {
            document.getElementById('calcTab').classList.remove('active');
            document.getElementById('prodTab').classList.remove('active');
            document.getElementById('calcView').classList.add('hidden');
            document.getElementById('prodView').classList.add('hidden');
            if(t==='calc') {
                document.getElementById('calcTab').classList.add('active');
                document.getElementById('calcView').classList.remove('hidden');
            } else {
                document.getElementById('prodTab').classList.add('active');
                document.getElementById('prodView').classList.remove('hidden');
            }
        }

        function calc() {
            var dur = parseInt(document.getElementById('duration').value);
            var int = document.getElementById('intensity').value;
            var temp = parseInt(document.getElementById('temperature').value);
            var hum = parseInt(document.getElementById('humidity').value);
            var wt = parseInt(document.getElementById('bodyWeight').value);
            var act = document.getElementById('activity').value;
            var sr = document.getElementById('sweatRate').value;

            var hrs = dur/60;
            var wtkg = wt/2.205;
            
            var cph = dur<=60 ? 30 : dur<=150 ? 60 : 90;
            var im = {zone1:0.6,zone2:0.8,zone3:1.0,zone4:1.2,zone5:1.4}[int];
            cph *= im;
            var tc = Math.round(cph*hrs);
            
            var fph = 500;
            var tempC = (temp-32)*5/9;
            if(tempC>25) fph += (tempC-25)*20;
            if(tempC<10) fph -= 100;
            if(hum>70) fph += 100;
            if(hum<40) fph -= 50;
            var am = {running:1.2,cycling:1.0,triathlon:1.1}[act];
            fph *= am;
            var sm = {low:0.8,medium:1.0,high:1.5}[sr];
            fph *= sm;
            var tf = Math.round(fph*hrs);
            
            var sph = 500*sm;
            if(tempC>25) sph += 200;
            var ts = Math.round(sph*hrs);
            
            var caf = dur>60 ? Math.round(3*wtkg) : 0;

            reqs = {c:tc,cph:Math.round(cph),f:tf,fph:Math.round(fph),s:ts,sph:Math.round(sph),caf:caf};

            document.getElementById('results').classList.remove('hidden');
            document.getElementById('totalCarbs').textContent = tc+'g';
            document.getElementById('carbsPerHour').textContent = Math.round(cph)+'g/hour';
            document.getElementById('totalFluid').textContent = tf+'ml';
            document.getElementById('fluidPerHour').textContent = Math.round(fph)+'ml/hour';
            document.getElementById('totalSodium').textContent = ts+'mg';
            document.getElementById('sodiumPerHour').textContent = Math.round(sph)+'mg/hour';
            document.getElementById('totalCaffeine').textContent = caf+'mg';
            
            document.getElementById('prodTab').disabled = false;
            showTab('prod');
        }

        function add(cat) {
            var sel = document.getElementById('sel'+cat);
            var qty = parseInt(document.getElementById('qty'+cat).value) || 1;
            var pn = sel.value;
            if(!pn) { alert('Select a product'); return; }
            
            var p = db[cat-1].find(function(x){return x.n===pn;});
            if(!p) return;
            
            picks.push({n:p.n,c:p.c,s:p.s,cal:p.cal,cat:cat,q:qty,id:Date.now()+Math.random()});
            sel.value = '';
            document.getElementById('qty'+cat).value = 1;
            upd();
        }

        function rem(id) {
            picks = picks.filter(function(p){return p.id!==id;});
            upd();
        }

        function chg(id,q) {
            var p = picks.find(function(x){return x.id===id;});
            if(p) { p.q = parseInt(q)||1; upd(); }
        }

        function upd() {
            var box = document.getElementById('selectedBox');
            var lst = document.getElementById('prodList');
            
            if(picks.length===0) {
                box.classList.add('hidden');
                return;
            }
            box.classList.remove('hidden');
            
            var totC=0,totS=0,totCal=0;
            picks.forEach(function(p){
                totC += p.c*p.q;
                totS += p.s*p.q;
                totCal += p.cal*p.q;
            });
            
            var html = '';
            picks.forEach(function(p){
                var cn = ['Liquids','Gels & Solids','Electrolytes','Whole Foods'][p.cat-1];
                html += '<div class="product-item">';
                html += '<div class="product-info">';
                html += '<div class="product-name">'+p.n+'</div>';
                html += '<div class="product-category">('+cn+')</div>';
                html += '<div class="product-details">Qty: '+p.q+' | '+(p.c*p.q)+'g carbs | '+(p.s*p.q)+'mg sodium</div>';
                html += '</div>';
                html += '<div class="product-controls">';
                html += '<input type="number" class="qty-input" value="'+p.q+'" min="1" max="20" onchange="chg('+p.id+',this.value)">';
                html += '<button class="btn btn-remove" onclick="rem('+p.id+')">Remove</button>';
                html += '</div></div>';
            });
            lst.innerHTML = html;
            
            if(reqs) {
                var rc = Math.max(0,reqs.c-totC);
                var rs = Math.max(0,reqs.s-totS);
                document.getElementById('remCarbs').textContent = rc+'g';
                document.getElementById('remCarbs').className = 'result-value '+(rc<=0?'green':'orange');
                document.getElementById('carbsProg').textContent = totC+'g of '+reqs.c+'g';
                document.getElementById('remSodium').textContent = rs+'mg';
                document.getElementById('remSodium').className = 'result-value '+(rs<=0?'green':'orange');
                document.getElementById('sodiumProg').textContent = totS+'mg of '+reqs.s+'mg';
                document.getElementById('totalCal').textContent = totCal;
            }
        }
    </script>
</body>
</html>